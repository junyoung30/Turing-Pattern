# νλ§ ν¨ν„΄ λ¶„λ¥λ¥Ό μ„ν• μ‹λ®¬λ μ΄μ… κΈ°λ° λ°μ΄ν„° μƒμ„± λ° CNN ν•™μµ νμ΄ν”„λΌμΈ

λ³Έ ν”„λ΅μ νΈλ” λ°μ‘-ν™•μ‚° λ°©μ •μ‹(Reaction-Diffusion System)μ„ κΈ°λ°μΌλ΅ 2μ°¨μ› νλ§ ν¨ν„΄μ„ μ‹λ®¬λ μ΄μ…ν•κ³ , μƒμ„±λ ν¨ν„΄ λ°μ΄ν„°λ¥Ό μ΄μ©ν•μ—¬ CNN λ¨λΈμ„ ν•™μµΒ·λ¶„λ¥ν•λ” End-to-End νμ΄ν”„λΌμΈμ„ μ κ³µν•©λ‹λ‹¤.

# π€ μ‚¬μ© λ°©λ²• (How to Use)

μ΄ ν”„λ΅μ νΈλ” μ‹λ®¬λ μ΄μ…μ„ μ΄μ©ν• λ°μ΄ν„° μƒμ„±κ³Ό CNN ν•™μµμ μ „μ²΄ νμ΄ν”„λΌμΈμ„ μ κ³µν•©λ‹λ‹¤.
νμ΄μ¬ 3.12 ν™κ²½μ—μ„ κ°λ° λ° μ‹¤ν—λμ—μµλ‹λ‹¤.

---

### 1) Install dependencies
ν•„μ”ν• λ¨λ“  λΌμ΄λΈλ¬λ¦¬λ¥Ό μ„¤μΉν•©λ‹λ‹¤.

```bash
pip install -r requirements.txt
```

---

### π”§Solver μµμ…

ν¨ν„΄ μƒμ„±μ„ μ„ν• μ—¬λ¬ μμΉ ν•΄μ„ solverλ¥Ό μ§€μ›ν•©λ‹λ‹¤.
`--solver` μµμ…μ„ ν†µν•΄ μ‚¬μ©ν•  solverλ¥Ό μ„ νƒν•  μ μμµλ‹λ‹¤.

| Solver | Description |
|--------|-------------|
| `fft_numpy` | Numpy κΈ°λ° FFT Solver (CPU) |
| `fft_jax`   | JAX κΈ°λ° FFT Solver (GPU) |

### 2) Generate patterns (test)
μ„ νƒν• νλΌλ―Έν„°(Dv, k1)μ— λ€ν•΄ 2D ν¨ν„΄μ„ μ‹λ®¬λ μ΄μ…ν•©λ‹λ‹¤. 
λ°μ΄ν„°μ…‹μ„ κµ¬μ¶•ν•κΈ° μ „μ—, ν•΄λ‹Ή νλΌλ―Έν„° μ΅°ν•©μ΄ μ–΄λ–¤ ν¨ν„΄μ„ μƒμ„±ν•λ”μ§€ μ‚¬μ „μ— ν™•μΈν•λ” μ©λ„λ΅ μ‚¬μ©ν•©λ‹λ‹¤.

```bash
python generate_pattern.py \
    --solver fft_numpy \
    --Dv 0.01 \
    --k1 5 \
    --seed 1004
```

---

### 3) Build Dataset
μ—¬λ¬ νλΌλ―Έν„° μ΅°ν•©κ³Ό seedsλ¥Ό μ΄μ©ν•΄ ν•™μµμ© λ°μ΄ν„°μ…‹μ„ μƒμ„±ν•©λ‹λ‹¤.

```bash
python generate_dataset.py \
    --solver fft_numpy \
    --points 0.01,5,Sdot 0.04,1,Ldot \
    --seeds 1 2 3 4 5
```

---

### 4) Run training
μƒμ„±λ λ°μ΄ν„°μ…‹μ„ κΈ°λ°μΌλ΅ CNN λ¨λΈμ„ ν•™μµν•©λ‹λ‹¤.

```bash
python train.py \
    --num_blocks 1 \
    --num_conv 6 \
    --aug 0 \
    --weight_seed 2025
```
